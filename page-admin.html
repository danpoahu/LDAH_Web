<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LDAH Page Editor - Who We Are</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-blue: #004E7C;
            --light-blue: #0066a1;
            --accent-teal: #4DD0E1;
            --text-dark: #1a1a1a;
            --text-light: #666;
            --bg-light: #f8f9fa;
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; }
        h1, h2, h3 { font-family: 'Poppins', sans-serif; font-weight: 700; line-height: 1.2; }
        
        /* Admin Panel */
        .admin-panel {
            position: fixed; right: 0; top: 0; bottom: 0;
            width: 380px; background: white;
            box-shadow: -4px 0 20px rgba(0,0,0,0.15);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000; overflow-y: auto;
        }
        .admin-panel.open { transform: translateX(0); }
        
        .admin-panel-header {
            background: var(--primary-blue);
            color: white;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .admin-toggle {
            position: fixed; right: 20px; bottom: 20px;
            z-index: 999; padding: 14px 24px;
            background: var(--primary-blue); color: white;
            border-radius: 50px; border: none;
            box-shadow: 0 4px 20px rgba(0, 78, 124, 0.4);
            cursor: pointer; font-weight: 600;
            font-size: 1rem;
        }
        .admin-toggle:hover { background: var(--light-blue); }
        
        /* Editable sections */
        .editable-section {
            position: relative;
            border: 2px dashed transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 8px;
            padding: 4px;
            margin: -4px;
        }
        .editable-section:hover {
            border-color: var(--accent-teal);
            background-color: rgba(77, 208, 225, 0.1);
        }
        .edit-indicator {
            position: absolute; top: -12px; right: 5px;
            background: var(--accent-teal); color: var(--primary-blue);
            padding: 2px 10px; font-size: 11px;
            border-radius: 4px; font-weight: 600;
            opacity: 0; transition: opacity 0.3s ease;
            pointer-events: none;
        }
        .editable-section:hover .edit-indicator { opacity: 1; }
        
        /* Page Navigation */
        .page-nav {
            background: #1a1a2e;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .page-nav-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .page-nav h1 {
            color: white;
            font-size: 1.1rem;
            margin-right: auto;
        }
        .page-btn {
            background: rgba(255,255,255,0.1);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
            text-decoration: none;
        }
        .page-btn:hover, .page-btn.active {
            background: var(--primary-blue);
        }
        .page-btn.active {
            box-shadow: 0 0 0 2px white;
        }
        
        /* Page Preview */
        .page-preview {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: calc(100vh - 60px);
        }
        
        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, #004E7C 0%, #0066a1 100%);
            color: white;
            padding: 80px 20px 60px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            opacity: 1;
            background-image:
                linear-gradient(90deg, rgba(255, 255, 255, .08) 1px, transparent 1px),
                linear-gradient(rgba(255, 255, 255, .08) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, .12) 1px, transparent 1px),
                linear-gradient(rgba(255, 255, 255, .12) 1px, transparent 1px);
            background-size: 30px 30px, 30px 30px, 60px 60px, 60px 60px;
        }
        .hero-section > * { position: relative; z-index: 1; }
        .hero-section h1 { font-size: 2.8em; margin-bottom: 20px; }
        .hero-section p { font-size: 1.3em; max-width: 900px; margin: 0 auto; opacity: 0.95; }
        .highlight { color: var(--accent-teal); }
        
        /* Content Wrapper */
        .content-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 60px 20px;
        }
        
        /* Section Header */
        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }
        .section-header h2 {
            color: var(--primary-blue);
            font-size: 2rem;
            margin-bottom: 12px;
        }
        .section-header p {
            color: var(--text-light);
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
        }
        .section-badge {
            display: inline-block;
            padding: 0.5rem 1.5rem;
            background: rgba(77, 208, 225, 0.1);
            color: var(--primary-blue);
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        /* Info Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin-bottom: 60px;
        }
        .info-card {
            background: var(--bg-light);
            border-radius: 20px;
            padding: 2rem;
        }
        .info-card .card-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        .info-card h3 {
            font-size: 1.4rem;
            color: var(--primary-blue);
            margin-bottom: 0.75rem;
        }
        .info-card p, .info-card ul {
            color: var(--text-light);
            line-height: 1.7;
        }
        .info-card ul {
            list-style: none;
            margin-top: 0.5rem;
        }
        .info-card ul li {
            padding: 0.4rem 0;
        }
        .info-card ul li::before {
            content: '‚úì ';
            color: var(--accent-teal);
            font-weight: bold;
        }
        
        /* PTI Card */
        .pti-card {
            background: var(--bg-light);
            border-radius: 20px;
            padding: 2rem;
            max-width: 900px;
            margin: 0 auto 60px;
        }
        .pti-card .card-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        .pti-card h3 {
            font-size: 1.4rem;
            color: var(--primary-blue);
            margin-bottom: 0.75rem;
        }
        .pti-card p {
            color: var(--text-light);
            line-height: 1.7;
            margin-bottom: 1rem;
        }
        
        /* Gallery Section Placeholder */
        .gallery-section {
            background: var(--bg-light);
            padding: 60px 20px;
        }
        .gallery-placeholder {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            text-align: center;
            color: var(--text-light);
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* CTA Section */
        .cta-section {
            background: linear-gradient(135deg, #004E7C 0%, #0066a1 100%);
            color: white;
            padding: 80px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .cta-section::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: radial-gradient(circle, transparent 0, transparent 22px, rgba(255, 255, 255, 0.15) 22px, rgba(255, 255, 255, 0.15) 24px, transparent 24px);
            background-size: 48px 48px;
        }
        .cta-section > * { position: relative; z-index: 1; }
        .cta-section h2 { font-size: 2.5rem; margin-bottom: 1rem; }
        .cta-section p { font-size: 1.2rem; max-width: 700px; margin: 0 auto 2rem; opacity: 0.95; }
        .cta-buttons { display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; }
        .btn-primary {
            padding: 1rem 2rem;
            background: white;
            color: var(--primary-blue);
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
        }
        .btn-secondary {
            padding: 1rem 2rem;
            background: transparent;
            color: white;
            border: 2px solid white;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
        }
        
        /* Edit Form */
        .edit-form {
            padding: 1rem;
            display: none;
        }
        .edit-form.active { display: block; }
        .edit-form label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }
        .edit-form input, .edit-form textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 1rem;
            font-family: inherit;
        }
        .edit-form textarea {
            min-height: 120px;
            resize: vertical;
        }
        .edit-form input:focus, .edit-form textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
        }
        .btn-row { display: flex; gap: 0.5rem; }
        .btn-save {
            flex: 1;
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        .btn-save:hover { background: var(--light-blue); }
        .btn-cancel {
            flex: 1;
            background: #e2e8f0;
            color: var(--text-dark);
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        .btn-cancel:hover { background: #cbd5e1; }
        
        /* Welcome Panel */
        .welcome-panel { padding: 1.5rem; }
        .welcome-panel h3 { color: var(--primary-blue); margin-bottom: 1rem; }
        .welcome-panel ul { list-style: none; margin-bottom: 1.5rem; }
        .welcome-panel li { padding: 0.5rem 0; color: var(--text-light); }
        .welcome-panel li::before { content: "‚úì "; color: var(--primary-blue); }
        .login-box {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 1rem;
        }
        .login-box input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }
        .login-box button {
            width: 100%;
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        .logged-in-box {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            border-radius: 8px;
            padding: 1rem;
            display: none;
        }
        .logged-in-box.active { display: block; }
        .logged-in-box p { color: #166534; margin-bottom: 1rem; }
        .btn-logout {
            width: 100%;
            background: #ef4444;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        
        /* Responsive */
        @media (max-width: 1024px) {
            .cards-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 768px) {
            .admin-toggle, .admin-panel { display: none; }
            .hero-section h1 { font-size: 2rem; }
        }
    </style>
</head>
<body>
    <!-- Page Navigation -->
    <nav class="page-nav">
        <div class="page-nav-inner">
            <h1>üìÑ LDAH Page Editor</h1>
            <a href="page-admin-home.html" class="page-btn">Home</a>
            <span class="page-btn active">Who We Are</span>
            <a href="cms.html" class="page-btn" style="margin-left: auto;">‚Üê Back to CMS</a>
        </div>
    </nav>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-panel-header">
            <h2 style="font-size: 1.1rem;">‚úèÔ∏è Edit Content</h2>
        </div>
        
        <div class="edit-form" id="editForm">
            <label id="editLabel">Editing...</label>
            <input type="hidden" id="editId">
            <input type="hidden" id="editPage">
            <textarea id="editContent" placeholder="Enter content..."></textarea>
            <div class="btn-row">
                <button class="btn-cancel" onclick="cancelEdit()">Cancel</button>
                <button class="btn-save" onclick="saveContent()">üíæ Save</button>
            </div>
        </div>
        
        <div class="welcome-panel" id="welcomePanel">
            <h3>üëã Welcome!</h3>
            <ul>
                <li>Click any text with a teal border to edit</li>
                <li>Changes save to Firebase instantly</li>
                <li>Content updates on the live site</li>
            </ul>
            
            <div class="login-box" id="loginBox">
                <p style="font-size: 0.85rem; color: #666; margin-bottom: 0.75rem;">üîê Login to edit content:</p>
                <input type="email" id="adminEmail" placeholder="Email">
                <input type="password" id="adminPassword" placeholder="Password" onkeypress="if(event.key==='Enter')login()">
                <button onclick="login()">Login</button>
            </div>
            
            <div class="logged-in-box" id="loggedInBox">
                <p>‚úÖ <strong>Logged in!</strong></p>
                <p style="font-size: 0.85rem; color: #166534; margin-bottom: 1rem;" id="userEmail"></p>
                <button class="btn-logout" onclick="logout()">üö™ Logout</button>
            </div>
        </div>
    </div>

    <!-- Admin Toggle Button -->
    <button class="admin-toggle" id="adminToggle" onclick="toggleAdmin()">üìù Edit Mode</button>

    <!-- Page Preview -->
    <div class="page-preview" id="pagePreview">
        
        <!-- Hero Section -->
        <section class="hero-section">
            <div class="editable-section" onclick="editField('whoweare', 'heroTitle', 'Hero Title')">
                <span class="edit-indicator">‚úèÔ∏è Edit</span>
                <h1 id="whoweare-heroTitle">Who We Are</h1>
            </div>
            <div class="editable-section" onclick="editField('whoweare', 'heroSubtitle', 'Hero Subtitle')">
                <span class="edit-indicator">‚úèÔ∏è Edit</span>
                <p id="whoweare-heroSubtitle">Leadership in Disabilities & Achievement of Hawai'i is a <span class="highlight">501(c)(3) non-profit</span> founded in 1968 by parents of children with learning disabilities. Today, we serve families of children with any type of disability across Hawai'i and the Pacific Islands.</p>
            </div>
        </section>
        
        <!-- Mission, Vision, Values Section -->
        <div class="content-wrapper">
            <div class="section-header">
                <span class="section-badge">üå∫ Our Foundation</span>
                <div class="editable-section" onclick="editField('whoweare', 'foundationTitle', 'Foundation Section Title')">
                    <span class="edit-indicator">‚úèÔ∏è Edit</span>
                    <h2 id="whoweare-foundationTitle">Mission, Vision & Values</h2>
                </div>
                <div class="editable-section" onclick="editField('whoweare', 'foundationSubtitle', 'Foundation Section Subtitle')">
                    <span class="edit-indicator">‚úèÔ∏è Edit</span>
                    <p id="whoweare-foundationSubtitle">Guiding principles that drive our commitment to families and children with disabilities</p>
                </div>
            </div>

            <div class="cards-grid">
                <!-- Mission Card -->
                <div class="info-card">
                    <div class="card-icon">üéØ</div>
                    <div class="editable-section" onclick="editField('whoweare', 'missionTitle', 'Mission Title')">
                        <span class="edit-indicator">‚úèÔ∏è Edit</span>
                        <h3 id="whoweare-missionTitle">Our Mission</h3>
                    </div>
                    <div class="editable-section" onclick="editField('whoweare', 'missionText', 'Mission Text')">
                        <span class="edit-indicator">‚úèÔ∏è Edit</span>
                        <p id="whoweare-missionText">To enhance educational, work and life opportunities for children and youth with or at risk of disabilities by empowering them and their families through screening, identification, information, training, and mentoring, and by public outreach and advocacy.</p>
                    </div>
                </div>

                <!-- Vision Card -->
                <div class="info-card">
                    <div class="card-icon">üî≠</div>
                    <div class="editable-section" onclick="editField('whoweare', 'visionTitle', 'Vision Title')">
                        <span class="edit-indicator">‚úèÔ∏è Edit</span>
                        <h3 id="whoweare-visionTitle">Our Vision</h3>
                    </div>
                    <div class="editable-section" onclick="editField('whoweare', 'visionText', 'Vision Text')">
                        <span class="edit-indicator">‚úèÔ∏è Edit</span>
                        <p id="whoweare-visionText">Individuals have choice and access to educational, work and life opportunities to be successful regardless of their disabilities.</p>
                    </div>
                </div>

                <!-- Values Card -->
                <div class="info-card">
                    <div class="card-icon">üíé</div>
                    <div class="editable-section" onclick="editField('whoweare', 'valuesTitle', 'Values Title')">
                        <span class="edit-indicator">‚úèÔ∏è Edit</span>
                        <h3 id="whoweare-valuesTitle">Core Values</h3>
                    </div>
                    <div class="editable-section" onclick="editField('whoweare', 'valuesList', 'Values List (use &lt;li&gt; tags)')">
                        <span class="edit-indicator">‚úèÔ∏è Edit</span>
                        <ul id="whoweare-valuesList">
                            <li>Advocating for the Rights of Children with Disabilities</li>
                            <li>Putting Families First</li>
                            <li>Creating Partnerships</li>
                            <li>Improving Communication</li>
                            <li>Implementing Best-Practices & Innovation</li>
                            <li>Ensuring Accountability</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- PTI Card -->
            <div class="pti-card">
                <div class="card-icon">üèõÔ∏è</div>
                <div class="editable-section" onclick="editField('whoweare', 'ptiTitle', 'PTI Section Title')">
                    <span class="edit-indicator">‚úèÔ∏è Edit</span>
                    <h3 id="whoweare-ptiTitle">Parent Training & Information Center</h3>
                </div>
                <div class="editable-section" onclick="editField('whoweare', 'ptiText1', 'PTI Paragraph 1')">
                    <span class="edit-indicator">‚úèÔ∏è Edit</span>
                    <p id="whoweare-ptiText1">Through a contract with the United States Department of Education, Office of Special Education Programs (OSEP), LDAH has operated and served as The Parent Training and Information Center (PTI) for the State of Hawaii since 1990. As the PTI, LDAH provides education and training to parents, children, professionals and community members.</p>
                </div>
                <div class="editable-section" onclick="editField('whoweare', 'ptiText2', 'PTI Paragraph 2')">
                    <span class="edit-indicator">‚úèÔ∏è Edit</span>
                    <p id="whoweare-ptiText2">The majority of Parent Center staff and board are parents of children with disabilities, bringing personal experience and expertise when working with families.</p>
                </div>
            </div>

            <!-- Meet Our People Section Header -->
            <div class="section-header">
                <span class="section-badge">üë• Meet Our People</span>
                <div class="editable-section" onclick="editField('whoweare', 'teamTitle', 'Team Section Title')">
                    <span class="edit-indicator">‚úèÔ∏è Edit</span>
                    <h2 id="whoweare-teamTitle">The Team Behind LDAH</h2>
                </div>
                <div class="editable-section" onclick="editField('whoweare', 'teamSubtitle', 'Team Section Subtitle')">
                    <span class="edit-indicator">‚úèÔ∏è Edit</span>
                    <p id="whoweare-teamSubtitle">Dedicated professionals and volunteers committed to supporting families</p>
                </div>
            </div>
            
            <div class="gallery-placeholder">
                <p>üë• Team and Board members are managed in the CMS Team tab</p>
            </div>
        </div>

        <!-- Gallery Section -->
        <section class="gallery-section">
            <div class="content-wrapper" style="padding-top: 0; padding-bottom: 0;">
                <div class="section-header">
                    <span class="section-badge">üì∏ Our Community</span>
                    <div class="editable-section" onclick="editField('whoweare', 'galleryTitle', 'Gallery Section Title')">
                        <span class="edit-indicator">‚úèÔ∏è Edit</span>
                        <h2 id="whoweare-galleryTitle">LDAH in Action</h2>
                    </div>
                    <div class="editable-section" onclick="editField('whoweare', 'gallerySubtitle', 'Gallery Section Subtitle')">
                        <span class="edit-indicator">‚úèÔ∏è Edit</span>
                        <p id="whoweare-gallerySubtitle">Moments from our events, workshops, and community outreach</p>
                    </div>
                </div>
            </div>
            <div class="gallery-placeholder">
                <p>üì∏ Gallery images are managed in the CMS</p>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta-section">
            <div class="editable-section" onclick="editField('whoweare', 'ctaTitle', 'CTA Title')">
                <span class="edit-indicator">‚úèÔ∏è Edit</span>
                <h2 id="whoweare-ctaTitle">Have Questions? We're Here to Help</h2>
            </div>
            <div class="editable-section" onclick="editField('whoweare', 'ctaSubtitle', 'CTA Subtitle')">
                <span class="edit-indicator">‚úèÔ∏è Edit</span>
                <p id="whoweare-ctaSubtitle">Our team is ready to assist you with information about special education, advocacy support, and navigating services for your child.</p>
            </div>
            <div class="cta-buttons">
                <a href="#" class="btn-primary">üìû Contact Us</a>
                <a href="#" class="btn-secondary">ü§ù Join Our Team</a>
            </div>
        </section>
        
    </div>

    <script>
        // Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyAU3CQ07bCVKlJ1qGak-150kaJEyPKldLk",
            authDomain: "ldah-932d5.firebaseapp.com",
            projectId: "ldah-932d5",
            storageBucket: "ldah-932d5.firebasestorage.app",
            messagingSenderId: "662130454003",
            appId: "1:662130454003:web:437576d5a5811ecd8df686"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        
        let isLoggedIn = false;
        let pageContent = {};
        
        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            // Listen for auth state changes
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    isLoggedIn = true;
                    document.getElementById('loginBox').style.display = 'none';
                    document.getElementById('loggedInBox').classList.add('active');
                    document.getElementById('userEmail').textContent = user.email;
                } else {
                    isLoggedIn = false;
                    document.getElementById('loginBox').style.display = 'block';
                    document.getElementById('loggedInBox').classList.remove('active');
                }
            });
            
            // Load content from Firebase
            await loadContent();
        });
        
        async function loadContent() {
            try {
                const doc = await db.collection('pageContent').doc('whoweare').get();
                if (doc.exists) {
                    pageContent = doc.data();
                    Object.keys(pageContent).forEach(key => {
                        const el = document.getElementById(`whoweare-${key}`);
                        if (el && pageContent[key]) {
                            el.innerHTML = pageContent[key];
                        }
                    });
                }
            } catch (err) {
                console.error('Error loading content:', err);
            }
        }
        
        function toggleAdmin() {
            const panel = document.getElementById('adminPanel');
            const toggle = document.getElementById('adminToggle');
            panel.classList.toggle('open');
            toggle.textContent = panel.classList.contains('open') ? '‚úñÔ∏è Close' : 'üìù Edit Mode';
        }
        
        async function login() {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            
            if (!email || !password) {
                alert('‚ö†Ô∏è Please enter both email and password');
                return;
            }
            
            try {
                document.querySelector('#loginBox button').textContent = 'Logging in...';
                document.querySelector('#loginBox button').disabled = true;
                
                await auth.signInWithEmailAndPassword(email, password);
                alert('‚úÖ Logged in! You can now edit page content.');
            } catch (err) {
                console.error('Login error:', err);
                let message = 'Login failed';
                if (err.code === 'auth/user-not-found') message = 'No account found with this email';
                else if (err.code === 'auth/wrong-password') message = 'Incorrect password';
                else if (err.code === 'auth/invalid-email') message = 'Invalid email address';
                alert('‚ùå ' + message);
            } finally {
                document.querySelector('#loginBox button').textContent = 'Login';
                document.querySelector('#loginBox button').disabled = false;
            }
        }
        
        async function logout() {
            try {
                await auth.signOut();
                alert('üëã Logged out');
            } catch (err) {
                console.error('Logout error:', err);
            }
        }
        
        function editField(pageId, fieldId, label) {
            if (!isLoggedIn) {
                alert('‚ö†Ô∏è Please login first');
                toggleAdmin();
                return;
            }
            
            document.getElementById('welcomePanel').style.display = 'none';
            document.getElementById('editForm').classList.add('active');
            
            document.getElementById('editLabel').textContent = `Editing: ${label}`;
            document.getElementById('editId').value = fieldId;
            document.getElementById('editPage').value = pageId;
            
            const currentContent = document.getElementById(`${pageId}-${fieldId}`)?.innerHTML || '';
            document.getElementById('editContent').value = currentContent.trim();
            
            if (!document.getElementById('adminPanel').classList.contains('open')) {
                toggleAdmin();
            }
        }
        
        async function saveContent() {
            const pageId = document.getElementById('editPage').value;
            const fieldId = document.getElementById('editId').value;
            const content = document.getElementById('editContent').value;
            
            try {
                await db.collection('pageContent').doc(pageId).set({
                    [fieldId]: content,
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                }, { merge: true });
                
                const el = document.getElementById(`${pageId}-${fieldId}`);
                if (el) el.innerHTML = content;
                
                pageContent[fieldId] = content;
                
                alert('‚úÖ Saved!');
                cancelEdit();
            } catch (err) {
                console.error('Save error:', err);
                alert('‚ùå Error saving: ' + err.message);
            }
        }
        
        function cancelEdit() {
            document.getElementById('editForm').classList.remove('active');
            document.getElementById('welcomePanel').style.display = 'block';
        }
    </script>
</body>
</html>
