<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LDAH Page Editor - Resources</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --primary-blue: #004E7C; --light-blue: #0066a1; --accent-teal: #4DD0E1; --text-dark: #1a1a1a; --text-light: #666; --bg-light: #f8f9fa; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', sans-serif; background: #f5f5f5; }
        h1, h2, h3 { font-family: 'Poppins', sans-serif; font-weight: 700; line-height: 1.2; }
        .admin-panel { position: fixed; right: 0; top: 0; bottom: 0; width: 380px; background: white; box-shadow: -4px 0 20px rgba(0,0,0,0.15); transform: translateX(100%); transition: transform 0.3s; z-index: 1000; overflow-y: auto; }
        .admin-panel.open { transform: translateX(0); }
        .admin-panel-header { background: var(--primary-blue); color: white; padding: 1rem; position: sticky; top: 0; z-index: 10; }
        .admin-toggle { position: fixed; right: 20px; bottom: 20px; z-index: 999; padding: 14px 24px; background: var(--primary-blue); color: white; border-radius: 50px; border: none; box-shadow: 0 4px 20px rgba(0,78,124,0.4); cursor: pointer; font-weight: 600; }
        .editable-section { position: relative; border: 2px dashed transparent; transition: all 0.3s; cursor: pointer; border-radius: 8px; padding: 4px; margin: -4px; }
        .editable-section:hover { border-color: var(--accent-teal); background: rgba(77,208,225,0.1); }
        .edit-indicator { position: absolute; top: -12px; right: 5px; background: var(--accent-teal); color: var(--primary-blue); padding: 2px 10px; font-size: 11px; border-radius: 4px; font-weight: 600; opacity: 0; transition: opacity 0.3s; pointer-events: none; }
        .editable-section:hover .edit-indicator { opacity: 1; }
        .page-nav { background: #1a1a2e; padding: 1rem; position: sticky; top: 0; z-index: 100; }
        .page-nav-inner { max-width: 1200px; margin: 0 auto; display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap; }
        .page-nav h1 { color: white; font-size: 1rem; margin-right: auto; }
        .page-btn { background: rgba(255,255,255,0.1); color: white; border: none; padding: 0.5rem 0.75rem; border-radius: 6px; cursor: pointer; font-size: 0.8rem; transition: all 0.2s; text-decoration: none; }
        .page-btn:hover, .page-btn.active { background: var(--primary-blue); }
        .page-btn.active { box-shadow: 0 0 0 2px var(--accent-teal); }
        .page-preview { max-width: 1200px; margin: 0 auto; background: white; min-height: calc(100vh - 60px); }
        .hero-section { background: linear-gradient(135deg, #004E7C, #0066a1); color: white; padding: 80px 20px 60px; text-align: center; position: relative; }
        .hero-section::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: linear-gradient(90deg, rgba(255,255,255,.08) 1px, transparent 1px), linear-gradient(rgba(255,255,255,.08) 1px, transparent 1px); background-size: 30px 30px; }
        .hero-section > * { position: relative; z-index: 1; }
        .hero-section h1 { font-size: 2.5em; margin-bottom: 15px; }
        .hero-section p { font-size: 1.1em; max-width: 700px; margin: 0 auto; opacity: 0.95; }
        .content-wrapper { max-width: 1200px; margin: 0 auto; padding: 50px 20px; }
        .placeholder { background: var(--bg-light); padding: 3rem; border-radius: 12px; text-align: center; color: var(--text-light); margin: 1rem 0; }
        .cta-section { background: linear-gradient(135deg, #004E7C, #0066a1); color: white; padding: 60px 20px; text-align: center; position: relative; }
        .cta-section::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: radial-gradient(circle, transparent 22px, rgba(255,255,255,0.1) 22px, rgba(255,255,255,0.1) 24px, transparent 24px); background-size: 48px 48px; }
        .cta-section > * { position: relative; z-index: 1; }
        .cta-section h2 { font-size: 2rem; margin-bottom: 15px; }
        .cta-section p { font-size: 1.1rem; max-width: 600px; margin: 0 auto; opacity: 0.95; }
        .edit-form { padding: 1rem; display: none; }
        .edit-form.active { display: block; }
        .edit-form label { display: block; font-weight: 600; margin-bottom: 0.5rem; }
        .edit-form textarea { width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem; margin-bottom: 1rem; font-family: inherit; min-height: 120px; resize: vertical; }
        .btn-row { display: flex; gap: 0.5rem; }
        .btn-save { flex: 1; background: var(--primary-blue); color: white; border: none; padding: 0.75rem; border-radius: 8px; font-weight: 600; cursor: pointer; }
        .btn-cancel { flex: 1; background: #e2e8f0; color: var(--text-dark); border: none; padding: 0.75rem; border-radius: 8px; font-weight: 600; cursor: pointer; }
        .welcome-panel { padding: 1.5rem; }
        .welcome-panel h3 { color: var(--primary-blue); margin-bottom: 1rem; }
        .welcome-panel ul { list-style: none; margin-bottom: 1.5rem; }
        .welcome-panel li { padding: 0.4rem 0; color: var(--text-light); }
        .welcome-panel li::before { content: "âœ“ "; color: var(--primary-blue); }
        .login-box { background: #f0f9ff; border: 1px solid #bae6fd; border-radius: 8px; padding: 1rem; }
        .login-box input { width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px; margin-bottom: 0.5rem; }
        .login-box button { width: 100%; background: var(--primary-blue); color: white; border: none; padding: 0.75rem; border-radius: 8px; font-weight: 600; cursor: pointer; }
        .logged-in-box { background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 1rem; display: none; }
        .logged-in-box.active { display: block; }
        .btn-logout { width: 100%; background: #ef4444; color: white; border: none; padding: 0.75rem; border-radius: 8px; font-weight: 600; cursor: pointer; }
    </style>
</head>
<body>
    <nav class="page-nav">
        <div class="page-nav-inner">
            <h1>ğŸ“„ Page Editor</h1>
            <a href="page-admin-home.html" class="page-btn">ğŸ  Home</a>
            <a href="page-admin-whoweare.html" class="page-btn">ğŸ‘¥ Who We Are</a>
            <a href="page-admin-events.html" class="page-btn">ğŸ“… Events</a>
            <a href="page-admin-volunteer.html" class="page-btn">ğŸ¤ Volunteer</a>
            <span class="page-btn active">ğŸ“š Resources</span>
            <a href="cms.html" class="page-btn" style="margin-left: auto;">â† CMS</a>
        </div>
    </nav>

    <div class="admin-panel" id="adminPanel">
        <div class="admin-panel-header"><h2 style="font-size: 1.1rem;">âœï¸ Edit Content</h2></div>
        <div class="edit-form" id="editForm">
            <label id="editLabel">Editing...</label>
            <input type="hidden" id="editId"><input type="hidden" id="editPage">
            <textarea id="editContent"></textarea>
            <div class="btn-row"><button class="btn-cancel" onclick="cancelEdit()">Cancel</button><button class="btn-save" onclick="saveContent()">ğŸ’¾ Save</button></div>
        </div>
        <div class="welcome-panel" id="welcomePanel">
            <h3>ğŸ‘‹ Welcome!</h3>
            <ul><li>Click any text to edit</li><li>Changes save to Firebase</li><li>Updates appear on live site</li></ul>
            <div class="login-box" id="loginBox">
                <p style="font-size: 0.85rem; color: #666; margin-bottom: 0.75rem;">ğŸ” Login to edit:</p>
                <input type="email" id="adminEmail" placeholder="Email">
                <input type="password" id="adminPassword" placeholder="Password" onkeypress="if(event.key==='Enter')login()">
                <button onclick="login()">Login</button>
            </div>
            <div class="logged-in-box" id="loggedInBox">
                <p>âœ… Logged in as:</p><p id="userEmail" style="font-size: 0.85rem; margin-bottom: 1rem;"></p>
                <button class="btn-logout" onclick="logout()">ğŸšª Logout</button>
            </div>
        </div>
    </div>
    <button class="admin-toggle" id="adminToggle" onclick="toggleAdmin()">ğŸ“ Edit</button>

    <div class="page-preview">
        <!-- Hero -->
        <section class="hero-section">
            <div class="editable-section" onclick="editField('resources','heroTitle','Page Title')"><span class="edit-indicator">âœï¸</span><h1 id="resources-heroTitle">ğŸ“š Resources</h1></div>
            <div class="editable-section" onclick="editField('resources','heroSubtitle','Page Subtitle')"><span class="edit-indicator">âœï¸</span><p id="resources-heroSubtitle">Find helpful resources for families and children with disabilities throughout Hawaii and the Pacific Islands.</p></div>
        </section>

        <!-- Resources List -->
        <div class="content-wrapper">
            <div class="placeholder">ğŸ“š Resources are loaded dynamically from Firebase with search and filter functionality (managed in CMS Resources tab)</div>
        </div>

        <!-- CTA -->
        <section class="cta-section">
            <div class="editable-section" onclick="editField('resources','ctaTitle','CTA Title')"><span class="edit-indicator">âœï¸</span><h2 id="resources-ctaTitle">Need Help Finding the Right Resource?</h2></div>
            <div class="editable-section" onclick="editField('resources','ctaSubtitle','CTA Subtitle')"><span class="edit-indicator">âœï¸</span><p id="resources-ctaSubtitle">Our team is here to guide you through options and connect you with the support your family needs.</p></div>
        </section>
    </div>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyAU3CQ07bCVKlJ1qGak-150kaJEyPKldLk", authDomain: "ldah-932d5.firebaseapp.com", projectId: "ldah-932d5", storageBucket: "ldah-932d5.firebasestorage.app", messagingSenderId: "662130454003", appId: "1:662130454003:web:437576d5a5811ecd8df686" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(), auth = firebase.auth();
        let isLoggedIn = false, pageContent = {};

        auth.onAuthStateChanged(user => {
            isLoggedIn = !!user;
            document.getElementById('loginBox').style.display = user ? 'none' : 'block';
            document.getElementById('loggedInBox').classList.toggle('active', !!user);
            if (user) document.getElementById('userEmail').textContent = user.email;
        });

        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const doc = await db.collection('pageContent').doc('resources').get();
                if (doc.exists) { pageContent = doc.data(); Object.keys(pageContent).forEach(k => { const el = document.getElementById('resources-' + k); if (el && pageContent[k]) el.innerHTML = pageContent[k]; }); }
            } catch (e) { console.error(e); }
        });

        function toggleAdmin() { const p = document.getElementById('adminPanel'); p.classList.toggle('open'); document.getElementById('adminToggle').textContent = p.classList.contains('open') ? 'âœ–ï¸ Close' : 'ğŸ“ Edit'; }
        async function login() { const e = document.getElementById('adminEmail').value, p = document.getElementById('adminPassword').value; if (!e || !p) return alert('Enter email and password'); try { await auth.signInWithEmailAndPassword(e, p); alert('âœ… Logged in!'); } catch (err) { alert('âŒ ' + err.message); } }
        async function logout() { await auth.signOut(); alert('ğŸ‘‹ Logged out'); }
        function editField(page, field, label) { if (!isLoggedIn) { alert('Please login first'); toggleAdmin(); return; } document.getElementById('welcomePanel').style.display = 'none'; document.getElementById('editForm').classList.add('active'); document.getElementById('editLabel').textContent = 'Editing: ' + label; document.getElementById('editId').value = field; document.getElementById('editPage').value = page; document.getElementById('editContent').value = (document.getElementById(page + '-' + field)?.innerHTML || '').trim(); if (!document.getElementById('adminPanel').classList.contains('open')) toggleAdmin(); }
        async function saveContent() { const page = document.getElementById('editPage').value, field = document.getElementById('editId').value, content = document.getElementById('editContent').value; try { await db.collection('pageContent').doc(page).set({ [field]: content, updatedAt: firebase.firestore.FieldValue.serverTimestamp() }, { merge: true }); const el = document.getElementById(page + '-' + field); if (el) el.innerHTML = content; alert('âœ… Saved!'); cancelEdit(); } catch (e) { alert('âŒ ' + e.message); } }
        function cancelEdit() { document.getElementById('editForm').classList.remove('active'); document.getElementById('welcomePanel').style.display = 'block'; }
    </script>
</body>
</html>
